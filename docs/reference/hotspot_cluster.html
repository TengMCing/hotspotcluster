<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatiotemporal clustering of hotspots — hotspot_cluster • spotoroo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Spatiotemporal clustering of hotspots — hotspot_cluster" />
<meta property="og:description" content="hotspot_cluster() cluster hotspots into fires. It can be used to
reconstruct fire history and detect fire ignition points." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spotoroo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatiotemporal clustering of hotspots</h1>
    
    <div class="hidden name"><code>hotspot_cluster.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>hotspot_cluster()</code> cluster hotspots into fires. It can be used to
reconstruct fire history and detect fire ignition points.</p>
    </div>

    <pre class="usage"><span class='fu'>hotspot_cluster</span><span class='op'>(</span>
  <span class='va'>hotspots</span>,
  lon <span class='op'>=</span> <span class='st'>"lon"</span>,
  lat <span class='op'>=</span> <span class='st'>"lat"</span>,
  obsTime <span class='op'>=</span> <span class='st'>"obsTime"</span>,
  activeTime <span class='op'>=</span> <span class='fl'>24</span>,
  adjDist <span class='op'>=</span> <span class='fl'>3000</span>,
  minPts <span class='op'>=</span> <span class='fl'>4</span>,
  minTime <span class='op'>=</span> <span class='fl'>3</span>,
  ignitionCenter <span class='op'>=</span> <span class='st'>"mean"</span>,
  timeUnit <span class='op'>=</span> <span class='cn'>NULL</span>,
  timeStep <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>hotspots</th>
      <td><p>list/data frame; a list or data frame which
contains information of hotspots.</p></td>
    </tr>
    <tr>
      <th>lon</th>
      <td><p>character; the name of the column of the list which contains
numeric longitude values.</p></td>
    </tr>
    <tr>
      <th>lat</th>
      <td><p>character; the name of the column of the list which contains
numeric latitude values.</p></td>
    </tr>
    <tr>
      <th>obsTime</th>
      <td><p>character; the name of the column of the list which contains
the observed time of hotspots in date, datetime or
numeric. Only if this column is a positive
integer vector, <code>timeUnit</code> and <code>timeStep</code>
do not need to be specified.</p></td>
    </tr>
    <tr>
      <th>activeTime</th>
      <td><p>numeric (&gt;=0); time tolerance; unit is time index.</p></td>
    </tr>
    <tr>
      <th>adjDist</th>
      <td><p>numeric (&gt;0); distance tolerance; unit is metre.</p></td>
    </tr>
    <tr>
      <th>minPts</th>
      <td><p>numeric (&gt;0); minimum number of hotspots in a cluster.</p></td>
    </tr>
    <tr>
      <th>minTime</th>
      <td><p>numeric (&gt;=0); minimum length of time of a cluster;
unit is time index.</p></td>
    </tr>
    <tr>
      <th>ignitionCenter</th>
      <td><p>character; method to calculate ignition points,
either "mean" or "median".</p></td>
    </tr>
    <tr>
      <th>timeUnit</th>
      <td><p><strong>OPTIONAL</strong>; character; one of "s" (seconds),
"m" (minutes), "h" (hours),
"d" (days) and "n" (numeric).</p></td>
    </tr>
    <tr>
      <th>timeStep</th>
      <td><p><strong>OPTIONAL</strong>; numeric (&gt;0); number of units of <code>timeUnit</code> in
a time step.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>spotoroo</code> object; the clustering result; it is also a list:</p><ul>
<li><p><code>hotspots</code> : a data frame contains information of hotspots.</p><ul>
<li><p><code>lon</code> : longitude.</p></li>
<li><p><code>lat</code> : latitude.</p></li>
<li><p><code>obsTime</code> : observed time.</p></li>
<li><p><code>timeID</code> : time index.</p></li>
<li><p><code>membership</code> : membership label.</p></li>
<li><p><code>noise</code> : whether it is noise.</p></li>
<li><p><code>distToIgnition</code> : distance to ignition.</p></li>
<li><p><code>distToIgnitionUnit</code> : unit of distance to ignition.</p></li>
<li><p><code>timeFromIgnition</code> : time from ignition.</p></li>
</ul></li>
<li><p><code>ignition</code> : a data frame contains information of ignition
points.</p><ul>
<li><p><code>lon</code> : longitude.</p></li>
<li><p><code>lat</code> : latitude.</p></li>
<li><p><code>obsTime</code> : observed time.</p></li>
<li><p><code>timeID</code> : time index.</p></li>
<li><p><code>obsInCluster</code> : number of observations in the cluster.</p></li>
<li><p><code>clusterTimeLen</code> : length of time of the cluster.</p></li>
</ul></li>
<li><p><code>setting</code> : a list contains the clustering settings.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If the observed time of the hotspot is given and it is not a postive
integer vector, parameter <code>timeUnit</code> and <code>timeStep</code> need to be
specified to convert date/datetime/numeric to time index.
More details can be found in <code><a href='transform_time_id.html'>transform_time_id()</a></code>.
<br /><br />
This clustering algorithm is consist of <strong>5 steps</strong>:
<br /><br />
In <strong>step 1</strong>, it defines \(T\) intervals using the time index
$$St = [max(1, t - activeTime),t]$$
where \(t = 1, 2, ..., T\), and \(T\) is the maximum time index.
<code>activeTime</code> is a parameter that needs to be specified. It represents
the maximum time difference between two hotspots in the same local
cluster. Please notice that a local cluster is different with a cluster
in the final result. More details will be given in the next part.
<br /><br />
In <strong>step 2</strong>, the algorithm performs spatial clustering on each interval.
A local cluster is a cluster found in an interval. Parameter <code>adjDist</code>
is used to control the spatial clustering. If the distance between two
hotspots is smaller or equal to <code>adjDist</code>, they are directly-connected. If
hotspot <code>A</code> is directly-connected with hotspot <code>B</code> and hotspot <code>B</code> is
directly-connected with hotspot <code>C</code>, hotspot <code>A</code>, <code>B</code> and <code>C</code> are
connected. All connected hotspots become a local cluster.
<br /><br />
In <strong>step 3</strong>, the algorithm starts from interval \(1\). It flags all
hotspots in this interval and records their membership labels.
Then it moves on to interval \(2\). Due to a hotspot could exist in
multiple intervals, it checks whether any hotspot in interval \(2\)
has been flagged. If there is any, their membership labels will be
carried over from the record. Unflagged hotspots in interval \(2\),
which share the same local cluster with flagged hotspots, their
membership labels are carried over from flagged hotspots. If a unflagged
hotspot shares the same local cluster with multiple flagged hotspots, the
algorithm will carry over the membership label from the nearest one. All
other unflagged hotspots in interval \(2\) that do not share the same
cluster with any flagged hotspot, their membership labels will be adjusted.
The clusters they belong to are considered to be new clusters. Finally, all
hotspots in interval \(2\) are flagged and their membership labels are
recorded. This process continues for interval \(3\), \(4\), ...,
\(T\). After finishing step 3, all hotspots are flagged and their
membership labels are recorded.
<br /><br />
In <strong>step 4</strong>, it checks each cluster. If there is any cluster contains less
than <code>minPts</code> hotspots, or lasts shorter than <code>minTime</code>, it will not be
considered to be a cluster any more, and their hotspots will be
assigned with <code>-1</code> as their membership labels. A hotspot with membership
label <code>-1</code> is noise.
Parameter <code>minPts</code> and <code>minTime</code> needs to be specified.
<br /><br />
In <strong>step 5</strong>, the algorithm finds the earliest observed hotspots in each
cluster and records them as ignition points. If there are multiple
earliest observed hotspots in a cluster, the mean or median of the
longitude values and the latitude values will be used as the coordinate
of the ignition point. This needs to be specified in parameter
<code>ignitionCenter</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>hotspot_cluster</span><span class='op'>(</span><span class='va'>hotspots_fin</span>,
                lon <span class='op'>=</span> <span class='st'>"lon"</span>,
                lat <span class='op'>=</span> <span class='st'>"lat"</span>,
                obsTime <span class='op'>=</span> <span class='st'>"obsTime"</span>,
                activeTime <span class='op'>=</span> <span class='fl'>24</span>,
                adjDist <span class='op'>=</span> <span class='fl'>3000</span>,
                minPts <span class='op'>=</span> <span class='fl'>4</span>,
                minTime <span class='op'>=</span> <span class='fl'>3</span>,
                ignitionCenter <span class='op'>=</span> <span class='st'>"mean"</span>,
                timeUnit <span class='op'>=</span> <span class='st'>"h"</span>,
                timeStep <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'><span style='color: #00BBBB;font-weight: bold;'>------------------------------ </span><span style='color: #000000;font-weight: bold;'>SPOTOROO 0.0.0.9000</span><span style='color: #00BBBB;font-weight: bold;'> -----------------------------</span><span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>-- </span><span style='font-weight: bold;'>Calling Core Function : </span><span style='color: #000000;background-color: #BBBBBB;font-weight: bold;'>`hotspot_cluster()`</span><span> --</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>-- </span><span style='color: #0000BB;'>1</span><span> </span><span style='color: #BB00BB;'>time index</span><span> = </span><span style='color: #0000BB;'>1</span><span> </span><span style='color: #BB00BB;'>hours</span><span> </span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BB00;'>√</span><span> </span><span style='color: #BBBB00;'>Transform</span><span> </span><span style='color: #00BB00;'>observed time</span><span> &gt; </span><span style='color: #00BB00;'>time indexes</span><span></span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;'>i</span><span> </span><span style='color: #0000BB;'>970</span><span> </span><span style='color: #BB00BB;'>time indexes</span><span> </span><span style='color: #555555;'>found</span><span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>-- </span><span style='color: #00BB00;'>activeTime</span><span> = </span><span style='color: #0000BB;'>24</span><span> </span><span style='color: #BB00BB;'>time indexes</span><span> | </span><span style='color: #00BB00;'>adjDist</span><span> = </span><span style='color: #0000BB;'>3000</span><span> </span><span style='color: #BB00BB;'>meters</span><span> </span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BB00;'>√</span><span> </span><span style='color: #BBBB00;'>Cluster</span><span></span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;'>i</span><span> </span><span style='color: #0000BB;'>16</span><span> clusters </span><span style='color: #555555;'>found (including noise)</span><span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>-- </span><span style='color: #00BB00;'>minPts</span><span> = </span><span style='color: #0000BB;'>4</span><span> </span><span style='color: #BB00BB;'>hotspots</span><span> | </span><span style='color: #00BB00;'>minTime</span><span> = </span><span style='color: #0000BB;'>3</span><span> </span><span style='color: #BB00BB;'>time indexes</span><span> </span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BB00;'>√</span><span> </span><span style='color: #BBBB00;'>Handle</span><span> </span><span style='color: #00BB00;'>noise</span><span></span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;'>i</span><span> </span><span style='color: #0000BB;'>6</span><span> clusters </span><span style='color: #555555;'>left</span><span></span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;'>i</span><span> noise </span><span style='color: #555555;'>proportion</span><span> : </span><span style='color: #0000BB;'>0.934579439252336 %</span><span> </span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>-- </span><span style='color: #00BB00;'>ignitionCenter</span><span> = </span><span style='color: #0000BB;'>'mean'</span><span> </span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BB00;'>√</span><span> </span><span style='color: #BBBB00;'>Compute</span><span> </span><span style='color: #00BB00;'>ignition points</span><span> </span><span style='color: #555555;'>for</span><span> clusters</span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;'>i</span><span> </span><span style='color: #555555;'>average</span><span> hotspots : 176.7</span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;'>i</span><span> </span><span style='color: #555555;'>average</span><span> duration : 131.9 </span><span style='color: #BB00BB;'>hours</span><span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>-- </span><span style='color: #00BB00;'>Time taken</span><span> = </span><span style='color: #0000BB;'>0</span><span> </span><span style='color: #BB00BB;'>mins</span><span> </span><span style='color: #0000BB;'>4</span><span> </span><span style='color: #BB00BB;'>secs</span><span> </span><span style='color: #555555;'>for</span><span> </span><span style='color: #0000BB;'>1070</span><span> hotspots </span></div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;'>i</span><span> </span><span style='color: #0000BB;'>0.004</span><span> </span><span style='color: #BB00BB;'>secs</span><span> </span><span style='color: #555555;'>per</span><span> hotspot</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'></span><span style='color: #00BBBB;font-weight: bold;'>--------------------------------------------------------------------------------</span><span></span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>result</span><span class='op'>)</span>
</div><div class='img'><img src='hotspot_cluster-1.png' alt='' width='700' height='433' /></div><div class='input'>

</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Weihao Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


