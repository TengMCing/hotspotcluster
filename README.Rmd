---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# spotoroo

<!-- badges: start -->
<!-- badges: end -->

The goal of spotoroo is to ...

## Installation

<!-- You can install the released version of spotoroo from [CRAN](https://CRAN.R-project.org) with: -->

<!-- ``` r -->
<!-- install.packages("spotoroo") -->
<!-- ``` -->

You can install the development version from [GitHub](https://github.com/) with:

``` r
install.packages("devtools")
devtools::install_github("TengMCing/spotoroo")
```
## Example

This is a basic example which shows you how to solve a common problem:

```{r echo = FALSE, message=FALSE, warning=FALSE, error=FALSE}
library(devtools)
load_all()
```

```{r}
library(spotoroo)
```


The built-in dataset `hotspots500`.

```{r}
str(hotspots500)
```

```{r}
hotspots500[1:10,]
```

```{r echo = TRUE, warning=FALSE, message=FALSE, error=FALSE, out.width = "70%", out.height="70%"}
library(tidyverse)
ggplot(hotspots500) +
  geom_sf(data = vic_map) +
  geom_point(aes(lon, lat), alpha = 0.3) +
  ggthemes::theme_map() +
  ggtitle("Raw Hotspots")
```


Perform spatiotemporal clustering on this dataset.

```{r example}
results <- hotspot_cluster(hotspots500, 
                           lon = "lon", 
                           lat = "lat", 
                           obsTime = "obsTime",
                           activeTime = 24,
                           adjDist = 3000,
                           minPts = 4,
                           ignitionCenter = "mean",
                           timeUnit = "h",
                           timeStep = 1)
```

The ignition points of the first 10 bushfires.

```{r}
results$ignitions[1:10,]
```

The memberships of the first 10 hotspots.

```{r}
results$hotspots[1:10,]
```

```{r echo = TRUE, warning=FALSE, message=FALSE, error=FALSE, out.width = "70%", out.height="70%"}
ggplot(results$ignitions) +
  geom_sf(data = vic_map) +
  geom_point(aes(lon, lat), alpha = 0.5) +
  ggthemes::theme_map() +
  ggtitle("Ignition Points")
```

<!-- Summary of the clustering result. -->

<!-- ```{r} -->
<!-- summary(results) -->
<!-- ``` -->



Plot of the result.

```{r out.width = "70%", out.height="70%"}
p <- ggplot() +
  geom_sf(data = vic_map) +
  ggthemes::theme_map()
plot(results,
     type = "static",
     clusters = "all",
     hotspots = TRUE, 
     noises = TRUE, 
     ignitions = TRUE, 
     bottom = p)
```


```{r out.width = "70%", out.height="70%"}
plot(results,
     type = "static",
     clusters = 1:3,
     hotspots = TRUE, 
     noises = FALSE, 
     ignitions = TRUE)
```


```{r out.width = "70%", out.height="70%"}
plot(results,
     type = "dynamic",
     clusters = 36,
     hotspots = TRUE, 
     noises = FALSE)
```
